{"ast":null,"code":"var _jsxFileName = \"G:\\\\repositories\\\\chat-app-starter\\\\frontend\\\\src\\\\components\\\\Sidebar.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { getChats } from '../api/chats';\nimport { getMessages } from '../api/messages';\nimport { auth, provider } from '../firebase';\nimport { signInWithPopup } from 'firebase/auth';\nimport './Sidebar.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Sidebar({\n  onSelect\n}) {\n  _s();\n  const [user, setUser] = useState(null);\n  const [chats, setChats] = useState([]);\n  const [search, setSearch] = useState('');\n  const [messagesMap, setMessagesMap] = useState({});\n  useEffect(() => {\n    const fetchChatsAndMessages = async () => {\n      const chatList = await getChats();\n      setChats(chatList);\n      const map = {};\n      for (const chat of chatList) {\n        const messages = await getMessages(chat._id);\n        if (messages.length > 0) {\n          const last = messages[messages.length - 1];\n          map[chat._id] = {\n            text: last.text,\n            date: new Date(last.createdAt).toLocaleDateString('en-US', {\n              month: 'short',\n              day: 'numeric',\n              year: 'numeric'\n            })\n          };\n        }\n      }\n      setMessagesMap(map);\n    };\n    fetchChatsAndMessages();\n  }, []);\n  const handleLogin = async () => {\n    try {\n      const result = await signInWithPopup(auth, provider);\n      setUser(result.user);\n    } catch (err) {\n      console.error('Login failed:', err);\n    }\n  };\n  const filteredChats = chats.filter(chat => `${chat.firstName} ${chat.lastName}`.toLowerCase().includes(search.toLowerCase()));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sidebar\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sidebar-top\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-login\",\n        children: user ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: user.photoURL,\n          alt: \"avatar\",\n          className: \"user-avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogin,\n          children: \"Log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"search-input\",\n        value: search,\n        onChange: e => setSearch(e.target.value),\n        placeholder: \"Search or start new chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      className: \"sidebar-title\",\n      children: \"Chats\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"chat-list\",\n      children: filteredChats.map(chat => {\n        const latest = messagesMap[chat._id];\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"chat-list-item\",\n          onClick: () => onSelect(chat),\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"https://via.placeholder.com/32\",\n            alt: \"avatar\",\n            className: \"chat-avatar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-header-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"chat-name\",\n                children: [chat.firstName, \" \", chat.lastName]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"chat-date\",\n                children: (latest === null || latest === void 0 ? void 0 : latest.date) || ''\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-last-message\",\n              children: (latest === null || latest === void 0 ? void 0 : latest.text) || 'No messages yet'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this)]\n        }, chat._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n_s(Sidebar, \"il7yIl/wUlYHar8arwLnKRSeXpU=\");\n_c = Sidebar;\nexport default Sidebar;\nvar _c;\n$RefreshReg$(_c, \"Sidebar\");","map":{"version":3,"names":["useState","useEffect","getChats","getMessages","auth","provider","signInWithPopup","jsxDEV","_jsxDEV","Sidebar","onSelect","_s","user","setUser","chats","setChats","search","setSearch","messagesMap","setMessagesMap","fetchChatsAndMessages","chatList","map","chat","messages","_id","length","last","text","date","Date","createdAt","toLocaleDateString","month","day","year","handleLogin","result","err","console","error","filteredChats","filter","firstName","lastName","toLowerCase","includes","className","children","src","photoURL","alt","fileName","_jsxFileName","lineNumber","columnNumber","onClick","value","onChange","e","target","placeholder","latest","_c","$RefreshReg$"],"sources":["G:/repositories/chat-app-starter/frontend/src/components/Sidebar.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { getChats } from '../api/chats';\r\nimport { getMessages } from '../api/messages';\r\nimport { auth, provider } from '../firebase';\r\nimport { signInWithPopup } from 'firebase/auth';\r\nimport './Sidebar.css';\r\n\r\nfunction Sidebar({ onSelect }) {\r\n  const [user, setUser] = useState(null);\r\n  const [chats, setChats] = useState([]);\r\n  const [search, setSearch] = useState('');\r\n  const [messagesMap, setMessagesMap] = useState({});\r\n\r\n  useEffect(() => {\r\n    const fetchChatsAndMessages = async () => {\r\n      const chatList = await getChats();\r\n      setChats(chatList);\r\n\r\n      const map = {};\r\n      for (const chat of chatList) {\r\n        const messages = await getMessages(chat._id);\r\n        if (messages.length > 0) {\r\n          const last = messages[messages.length - 1];\r\n          map[chat._id] = {\r\n            text: last.text,\r\n            date: new Date(last.createdAt).toLocaleDateString('en-US', {\r\n              month: 'short',\r\n              day: 'numeric',\r\n              year: 'numeric',\r\n            }),\r\n          };\r\n        }\r\n      }\r\n      setMessagesMap(map);\r\n    };\r\n\r\n    fetchChatsAndMessages();\r\n  }, []);\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      const result = await signInWithPopup(auth, provider);\r\n      setUser(result.user);\r\n    } catch (err) {\r\n      console.error('Login failed:', err);\r\n    }\r\n  };\r\n\r\n  const filteredChats = chats.filter(chat =>\r\n    `${chat.firstName} ${chat.lastName}`.toLowerCase().includes(search.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"sidebar\">\r\n      <div className=\"sidebar-top\">\r\n        <div className=\"sidebar-login\">\r\n          {user ? (\r\n            <img src={user.photoURL} alt=\"avatar\" className=\"user-avatar\" />\r\n          ) : (\r\n            <button onClick={handleLogin}>Log in</button>\r\n          )}\r\n        </div>\r\n        <input\r\n          className=\"search-input\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          placeholder=\"Search or start new chat\"\r\n        />\r\n      </div>\r\n\r\n      <h4 className=\"sidebar-title\">Chats</h4>\r\n\r\n      <ul className=\"chat-list\">\r\n        {filteredChats.map(chat => {\r\n          const latest = messagesMap[chat._id];\r\n          return (\r\n            <li key={chat._id} className=\"chat-list-item\" onClick={() => onSelect(chat)}>\r\n              <img src=\"https://via.placeholder.com/32\" alt=\"avatar\" className=\"chat-avatar\" />\r\n              <div className=\"chat-info\">\r\n                <div className=\"chat-header-row\">\r\n                  <span className=\"chat-name\">{chat.firstName} {chat.lastName}</span>\r\n                  <span className=\"chat-date\">{latest?.date || ''}</span>\r\n                </div>\r\n                <div className=\"chat-last-message\">\r\n                  {latest?.text || 'No messages yet'}\r\n                </div>\r\n              </div>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Sidebar;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}